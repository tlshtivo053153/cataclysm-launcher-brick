## 1. Goal
サンドボックスプロファイルに紐づくバックアップシステムの初期実装を行う。ユーザーが選択したプロファイルのセーブデータバックアップを作成し、既存のバックアップをリスト表示できるようにする。

## 2. Context
ゲームの進行状況（セーブデータ）はユーザーにとって最も重要な資産の一つである。サンドボックスごとにセーブデータが分離されたため、プロファイル単位で安全にデータをバックアップし、不慮の事故によるデータ損失を防ぐ仕組みが必要となる。

## 3. Scope
-   **UIの変更:**
    -   UIに4つ目のペインとして「Backups」を追加する。このペインは、サンドボックスプロファイルが選択された時に、そのプロファイルのバックアップを表示する。
-   **データモデルの拡張:**
    -   `src/Types.hs`に`BackupInfo`データ型を定義する。
-   **バックアップ制御ロジックの実装:**
    -   `src/BackupSystem.hs`を新規に作成する。
    -   `createBackup(profile)`: 指定されたプロファイルのセーブデータ（`save/`ディレクトリ）を圧縮アーカイブとして`backups/<プロファイル名>/`に保存する。
    -   `listBackups(profile)`: 指定されたプロファイルのバックアップ一覧を返す。
-   **既存モジュールの連携:**
    -   `app/UI.hs`: 新しいUIレイアウト（4ペイン）の描画を担当する。
    -   `app/Events.hs`: バックアップ作成をトリガーするイベント処理を追加する。
    -   `src/Types.hs`: `AppState`に、選択中プロファイルのバックアップリストを保持する状態を追加する。

## 4. Detailed Steps

1.  **型定義:**
    -   `src/Types.hs`に、バックアップ名、作成日時、ファイルパスなどを含む`BackupInfo`型を定義する。
    -   `AppState`に`appBackups :: List Name BackupInfo`を追加する。
    -   `Name`データコンストラクタに`BackupListName`を追加する。
    -   `ActiveList`に`BackupList`を追加する。

2.  **`BackupSystem.hs`の実装:**
    -   `listBackups(profile)`: `backups/<プロファイル名>/`ディレクトリをスキャンし、存在するバックアップファイルのリストを`[BackupInfo]`として返す。
    -   `createBackup(profile)`:
        -   プロファイルの`save/`ディレクトリの存在を確認する。
        -   `tar`と`gzip`を使い、ディレクトリを圧縮する。
        -   `backups/<プロファイル名>/<タイムスタンプ>.tar.gz`のような形式で保存する。

3.  **UIとイベント処理の統合:**
    -   `app/UI.hs`の`drawUI`を修正し、4ペインレイアウトを描画するように変更する。
    -   `app/Events.hs`の`handleEvent`を修正する。
        -   `SandboxProfileList`がアクティブな状態で特定のキー（例: `b`キー）が押されたら、`createBackup`を非同期で実行する。
        -   バックアップ作成完了後、バックアップリストを更新するイベントを追加する。
        -   サンドボックスプロファイルの選択が変更されたら、そのプロファイルに対応するバックアップリストを`listBackups`で再読み込みする。
    -   `app/Main.hs`を修正し、初期状態でバックアップリストが空になるように設定する。

4.  **テスト:**
    -   `BackupSystem.hs`の`createBackup`と`listBackups`に対して、一時ディレクトリとテストファイルを使用したユニットテストを追加する。

## 5. Non-Goal
-   バックアップからの復元機能。
-   バックアップの世代管理と自動ローテーション。
-   バックアップファイルのプレビュー機能。
-   バックアップの自動作成機能。
